<?xml version="1.0" encoding="UTF-8"?>
<con:testSuite id="4e66e212-b32f-4b8d-a200-5dc11d291c18" name="OOOVS-BaaS Test Suite_Archieved" disabled="true" xmlns:con="http://eviware.com/soapui/config"><con:settings><con:setting id="4e66e212-b32f-4b8d-a200-5dc11d291c18fileName">OOOVS-BaaS-Test-Suite_Archieved</con:setting></con:settings><con:runType>SEQUENTIAL</con:runType><con:properties><con:property><con:name>filePrefix</con:name><con:value>oovs_suite_</con:value></con:property><con:property><con:name>sshHost</con:name><con:value>192.168.250.181</con:value></con:property><con:property><con:name>sshUser</con:name><con:value>suyog</con:value></con:property><con:property><con:name>sshPass</con:name><con:value>7802#%Vu</con:value></con:property><con:property><con:name>sshPort</con:name><con:value>22</con:value></con:property><con:property><con:name>actJobQuery</con:name><con:value>cd /opt/Ooredoo_Oman/producer/retry/automation; java -jar InputProducer.jar Customer_Id=2 Provider_Id=2 Job_Type=1 Queue_Name=RENEWAL_QUEUE_AUTOMATION_AWS Host_Name=192.168.249.100 Product_Name=Ooredoo_Oman input_getUserAPI=http://192.168.249.94:8080/baas/rest/backendJob input_limit=500 isConsumer=false target=baas activityType=ACTIVATE</con:value></con:property><con:property><con:name>renJobQuery</con:name><con:value>cd /opt/Ooredoo_Oman/producer/renew/automation; java -jar InputProducer.jar Customer_Id=2 Provider_Id=2 Job_Type=2 Queue_Name=RENEWAL_QUEUE_AUTOMATION_AWS Host_Name=192.168.249.100 Product_Name=Ooredoo_Oman input_getUserAPI=http://192.168.249.94:8080/baas/rest/backendJob input_limit=500 isConsumer=false target=baas activityType=RENEW </con:value></con:property><con:property><con:name>autoChurnQuery</con:name><con:value>cd /opt/Ooredoo_Oman/producer/auto_churn;java -jar InputProducer.jar Customer_Id=2 Provider_Id=2 Job_Type=4 Queue_Name=AUTO_CHURN_QUEUE_AUTOMATION_AWS Host_Name=192.168.249.100 Product_Name=Ooredoo_Oman input_getUserAPI=http://192.168.249.94:8080/baas/rest/backendJob input_limit=500 isConsumer=false target=baas activityType=DEACTIVATION</con:value></con:property><con:property><con:name>outputfile</con:name><con:value>F:\baas_workspace\Output\oovs_suite_2016_02_12-19-48.txt</con:value></con:property><con:property><con:name>testProperty</con:name><con:value>vuclip</con:value></con:property></con:properties><con:setupScript>import java.text.*
import java.util.*

def path=context.expand('${#Global#output_path}')

Date date = new Date();
DateFormat dateFormat = new SimpleDateFormat("yyyy_MM_dd-HH-mm");
def df = dateFormat.format(date);
def prefix=testSuite.getPropertyValue("filePrefix")+df+".txt"

def resultFile = path+prefix
 File file = new File(resultFile)
testSuite.setPropertyValue( "outputfile", resultFile )
context.setProperty("resultfile",file)
</con:setupScript><con:tearDownScript>import javax.mail.*;
import javax.activation.*
import javax.mail.internet.*;
import java.util.*;
import java.text.DateFormat;
import java.text.SimpleDateFormat;

 // Recipient's email ID needs to be mentioned.
        String to = testSuite.project.getPropertyValue("recipients");
        
       // Sender's email ID needs to be mentioned
      String from = "vuclipqauser@gmail.com";//change accordingly
      final String username = "vuclipqauser";//change accordingly
      final String password = "vucliP@123";//change accordingly

      // Assuming you are sending email through relay.jangosmtp.net
      String host = "smtp.gmail.com";

      def props = new Properties();
      props.put("mail.smtp.auth", "true");
      props.put("mail.smtp.starttls.enable", "true");
      props.put("mail.smtp.host", host);
      props.put("mail.smtp.port", "587");

      // Get the Session object.
      Session session = Session.getInstance(props,
      new javax.mail.Authenticator() {
         protected PasswordAuthentication getPasswordAuthentication() {
            return new PasswordAuthentication(username, password);
         }
      });

      try {
         // Create a default MimeMessage object.
         Message message = new MimeMessage(session);

         // Set From: header field of the header.
         message.setFrom(new InternetAddress(from));

         // Set To: header field of the header.
         message.setRecipients(Message.RecipientType.TO,
         InternetAddress.parse(to));

         // Set Subject: header field
         message.setSubject(" Test Execution Report:"+testSuite.name);

     
         // Create the message part
            BodyPart messageBodyPart = new MimeBodyPart();
            StringBuffer emailMessage = new StringBuffer("Dear All,");
            emailMessage.append("\r\n");
            emailMessage.append("\r\n")
            emailMessage.append("Find attached "+testSuite.name+" Test Excecution Report");
            emailMessage.append("\r\n");
            emailMessage.append("\r\n\r\n");
            emailMessage.append("Thanks &amp; Regards");
            emailMessage.append("\r\n");
            emailMessage.append("Vuclip QA");              
         
         // Now set the actual message
           messageBodyPart.setText(emailMessage.toString());
         // Create a multipar message
         Multipart multipart = new MimeMultipart();

         // Set text message part
         multipart.addBodyPart(messageBodyPart);

         // Part two is attachment
         messageBodyPart = new MimeBodyPart();
         //String filename = context.getProperty("resultfile")
        String filename = testSuite.getPropertyValue( "outputfile")
        File outputfile=new File(filename)
         DataSource source = new FileDataSource(outputfile);
         messageBodyPart.setDataHandler(new DataHandler(source));
         messageBodyPart.setFileName(filename);
         multipart.addBodyPart(messageBodyPart);

         // Send the complete message parts
         message.setContent(multipart);

         // Send message
         if (context.expand('${#Global#is_mail_sent}')=='True')
         {
         Transport.send(message);
         }
         else{log.info "No Email Sent"}
      } catch (MessagingException e) {
            throw new RuntimeException(e);
      }</con:tearDownScript><con:reportParameters/></con:testSuite>